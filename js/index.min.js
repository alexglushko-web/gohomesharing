"use strict";window.addEventListener("DOMContentLoaded",()=>{class t{constructor(t,e,s,i="radio"){e.addEventListener("click",()=>{t.classList.toggle("active")}),s.forEach(a=>{let n=e.textContent,r=e.querySelector("span");a.addEventListener("click",()=>{if("radio"===i&&(e.querySelector("span")?e.querySelector("span").textContent=a.textContent:e.textContent=a.textContent,t.classList.toggle("active")),"checkbox"===i){a.classList.toggle("active"),r.innerHTML="";for(let t=0;t<s.length;t++)s[t].classList.contains("active")&&r.insertAdjacentHTML("beforeend",s[t].textContent+", ");r.textContent=r.textContent.slice(0,-2),r.textContent.length<1&&(r.textContent=n)}})})}}let e=document.querySelector(".city"),s=e.querySelector(".city__title"),i=e.querySelectorAll(".city__item");new t(e,s,i),C(e);let a=document.querySelector(".subway"),n=a.querySelector(".subway__title"),r=a.querySelectorAll(".subway__item");new t(a,n,r),C(a),document.querySelectorAll(".options__item.dropdown._pop-up").forEach(e=>{let s=e.querySelector(".dropdown__title"),i=e.querySelectorAll(".dropdown__item");new t(e,s,i,"checkbox"),C(e)});let l=document.querySelector(".startpage"),o=l.querySelector(".startpage__timer__container"),h=l.querySelector(".timer__clock"),d=l.querySelector(".timer__all-line"),c=l.querySelector(".timer__circle"),u=getComputedStyle(document.querySelector(".container")).maxWidth.split("px")[0];o.style.right=(document.body.clientWidth-u)/2+"px",c.setAttribute("r",getComputedStyle(d).width.split("px")[0]/2);let m=c.r.baseVal.value,_=parseInt(2*Math.PI*m+1),y=100;function v(t){let e=_-t/100*_;c.style.strokeDashoffset=e}c.style.strokeDasharray=`${_} ${_}`,c.style.strokeDashoffset=_,v(0),setInterval(()=>{let t=moment(Date.now())._d,e=(+moment(new Date(t.getFullYear(),t.getMonth(),t.getDate()+1,0))._d-+t)/1e3,s=Math.floor(e/3600%24),i=Math.floor(e/60%60),a=Math.floor(e%60);a=T(a),i=T(i),h.textContent=s+":"+i+":"+a,y>0&&(y-=5,v(e/86400*100))},1e3);let g=l.querySelectorAll(".type__item"),D=l.querySelectorAll(".options__list");g.forEach(t=>{t.addEventListener("click",()=>{for(let e=0;e<g.length;e++)g[e]==t?(g[e].classList.add("active"),D[e].classList.add("active")):(g[e].classList.remove("active"),D[e].classList.remove("active"))})});class M{constructor(t,e,s){this.nowDateHours=(new Date).getHours()+1,this.nowDateHours+1>23&&(this.nowDateHours=0),console.log(this.start),this.start=t.querySelectorAll(".options__item.time")[0],this.startTitle=this.start.querySelector(".time__title>span"),this.startItems=this.start.querySelectorAll(".time__item"),this.startHours=this.nowDateHours,this.startMinutes=0,this.startAdd=this.start.querySelector(".time__add"),this.startRemove=this.start.querySelector(".time__remove"),this.end=t.querySelectorAll(".options__item.time")[1],this.endTitle=this.end.querySelector(".time__title>span"),this.endItems=this.end.querySelectorAll(".time__item"),this.endHours,this.endMinutes,"mins"==s?(this.endHours=this.nowDateHours,this.endMinutes=30):(this.endHours=this.nowDateHours+1,this.endMinutes=0),this.endAdd=this.end.querySelector(".time__add"),this.endRemove=this.end.querySelector(".time__remove"),this.duration=t.querySelector(".duration"),this.durationTitle=this.duration.querySelector(".duration__title"),this.durationValue=e,this.startTitle.textContent=this.startHours+":"+T(this.startMinutes),this.endTitle.textContent=this.endHours+":"+T(this.endMinutes),this.durationSet(),C(this.start),C(this.end),this.startTitle.addEventListener("click",()=>{this.start.classList.toggle("active")}),this.startItems.forEach(t=>{t.addEventListener("click",()=>{this.startTitle.textContent=t.textContent,this.startHours=1*t.textContent.split(":")[0],this.startMinutes=1*t.textContent.split(":")[1],this.endHours<=this.startHours&&((s="mins")&&(this.endHours=this.startHours,this.endMinutes=30),(s="hours")&&(this.endMinutes=0,this.timeEndAdd(s))),this.durationSet(),this.endTitle.textContent=this.endHours+":"+T(this.endMinutes),this.start.classList.remove("active")})}),this.endTitle.addEventListener("click",()=>{this.end.classList.toggle("active")}),this.endItems.forEach(t=>{t.addEventListener("click",()=>{this.endTitle.textContent=t.textContent,this.endHours=1*t.textContent.split(":")[0],this.endMinutes=1*t.textContent.split(":")[1],this.endHours<=this.startHours&&("mins"==s&&(this.startHours=this.endHours-1,this.startMinutes=30),"hours"==s&&(this.startHours=this.endHours-1)),this.durationSet(),this.startTitle.textContent=this.startHours+":"+T(this.startMinutes),this.end.classList.remove("active")})}),this.startAdd.addEventListener("click",()=>{"mins"==s&&(this.startMinutes++,this.startMinutes>59&&(this.startHours++,this.startMinutes=0),23==this.startHours&&this.startMinutes>=29&&(this.startHours=23,this.startMinutes=29),this.durationValue<31&&(this.timeEndAdd("mins"),this.endTitle.textContent=this.endHours+":"+T(this.endMinutes))),"hours"==s&&(this.startHours++,this.startHours>=23&&(this.startHours=23,this.startMinutes=0),this.durationValue/60<2&&(this.timeEndAdd(s),this.endTitle.textContent=this.endHours+":"+T(this.endMinutes))),this.startTitle.textContent=this.startHours+":"+T(this.startMinutes),this.durationSet()}),this.startRemove.addEventListener("click",()=>{"mins"==s&&(this.startMinutes--,this.startMinutes<0&&(this.startHours--,this.startMinutes=59),-1==this.startHours&&(this.startHours=0,this.startMinutes=0)),"hours"==s&&(this.startHours--,this.startHours<=0&&(this.startHours=0,this.startMinutes=0)),this.startTitle.textContent=this.startHours+":"+T(this.startMinutes),this.durationSet()}),this.endAdd.addEventListener("click",()=>{this.timeEndAdd(s),this.endTitle.textContent=this.endHours+":"+T(this.endMinutes)}),this.endRemove.addEventListener("click",()=>{"mins"==s&&this.durationValue>30&&(this.endMinutes--,this.endMinutes<0&&(this.endHours--,this.endMinutes=59),-1==this.endHours&&(this.endHours=0,this.endMinutes=0)),"hours"==s&&(this.durationValue/60>1&&this.endHours--,59==this.endMinutes&&(this.endHours++,this.endMinutes=0)),this.endTitle.textContent=this.endHours+":"+T(this.endMinutes),this.durationSet()})}timeEndAdd(t="mins"){"mins"==t&&(this.endMinutes++,this.endMinutes>59&&(this.endHours++,this.endMinutes=0),24==this.endHours&&0==this.endMinutes&&(this.endHours=23,this.endMinutes=59)),"hours"==t&&(this.endHours++,this.endHours>23&&(this.endHours=23,this.endMinutes=59)),this.durationSet()}durationSet(){let t=60*this.endHours+this.endMinutes-(60*this.startHours+this.startMinutes),e=t%60,s=parseInt(t/60);this.durationValue=t,this.durationTitle.textContent=0==s?e:s+":"+T(e),this.durationTitle.insertAdjacentHTML("beforeend",'<i class="icon-clock"></i>')}}class S{constructor(t,e=new Date,s=0){this.element=t,this.date=new Date,this.activeDate=e,this.minDuration=s,this.months=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],this.monthsTitles=["Января","Февраля","Марта","Апреля","Мая","Июня","Июля","Августа","Сентября","Октября","Ноября","Декабря"],this.element.querySelector(".calendar__actual-time")&&(this.element.querySelector(".calendar__timepicker").value=this.beautyValue((new Date).getHours()+1)+":00",this.element.querySelector(".calendar__actual-time").addEventListener("click",()=>{let t=this.beautyValue((new Date).getHours()),e=this.beautyValue((new Date).getMinutes());this.element.querySelector(".calendar__timepicker").value=t+":"+e,this.element.querySelector(".calendar__time").innerHTML=t+":"+e})),this.element.querySelector(".calendar__actual-date")&&this.element.querySelector(".calendar__actual-date").addEventListener("click",()=>{this.renderCalendar(this.element),this.activeDate.setDate((new Date).getDate()),this.activeDate.setMonth((new Date).getMonth()),this.activeDate.setFullYear((new Date).getFullYear()),this.element.querySelector(".calendar__date>p").innerHTML=this.beautyValue(this.activeDate.getDate())+" "+this.beautyValue(this.monthsTitles[this.activeDate.getMonth()])+" "+this.activeDate.getFullYear(),this.element.querySelector(".calendar__title").innerHTML=this.beautyValue(this.activeDate.getDate())+"."+this.beautyValue(this.activeDate.getMonth()+1)+"."+this.activeDate.getFullYear(),this.correctTime()}),this.element.querySelector(".calendar__timepicker")&&this.element.querySelector(".calendar__timepicker").addEventListener("input",t=>{this.element.querySelector(".calendar__time").innerHTML=t.target.value,this.correctTime()}),this.element.querySelector(".calendar__prev").addEventListener("click",()=>{this.date.setMonth(this.date.getMonth()-1),this.activeDate.setMonth(this.date.getMonth()-1),this.activeDate.setFullYear(this.date.getFullYear()),this.activeDate.getMonth()>(new Date).getMonth()-2||this.activeDate.getFullYear()>(new Date).getFullYear()?this.renderCalendar(this.element):(this.date.setMonth((new Date).getMonth()),this.activeDate.setMonth((new Date).getMonth()))}),this.element.querySelector(".calendar__next").addEventListener("click",()=>{this.date.setMonth(this.date.getMonth()+1),this.activeDate.setMonth(this.date.getMonth()-1),this.renderCalendar(this.element)}),t.querySelector(".calendar__title").innerHTML=this.beautyValue(this.activeDate.getDate())+"."+this.beautyValue(this.activeDate.getMonth()+1)+"."+this.activeDate.getFullYear(),t.querySelector(".calendar__time")&&(t.querySelector(".calendar__time").innerHTML=this.activeDate.getHours()+1+":00"),t.querySelector(".calendar__send").addEventListener("click",()=>{t.classList.remove("active")}),this.renderCalendar(this.element)}renderCalendar(t){this.date.setDate(1),this.monthDays=t.querySelector(".calendar__days"),this.lastDay=new Date(this.date.getFullYear(),this.date.getMonth()+1,0).getDate(),this.prevLastDay=new Date(this.date.getFullYear(),this.date.getMonth(),0).getDate(),this.firstDayIndex=this.date.getDay(),this.lastDayIndex=new Date(this.date.getFullYear(),this.date.getMonth()+1,0).getDay(),this.nextDays=7-this.lastDayIndex-1,this.days="",t.querySelector(".calendar__date>span").innerHTML=this.months[this.date.getMonth()],t.querySelector(".calendar__date>p").innerHTML=(new Date).getDate()+" "+this.monthsTitles[(new Date).getMonth()]+" "+(new Date).getFullYear();for(let t=this.firstDayIndex-1+this.minDuration;t>0;t--)this.days+=`<div class="calendar__prev-date">${this.prevLastDay-t+1}</div>`;for(let t=1;t<=this.lastDay;t++)t===(new Date).getDate()&&this.date.getMonth()===(new Date).getMonth()?this.days+=`<div class="active">${t+this.minDuration}</div>`:this.days+=`<div>${t+this.minDuration}</div>`;for(let t=1;t<=this.nextDays+1;t++)this.days+=`<div class="calendar__next-date">${t}</div>`,this.monthDays.innerHTML=this.days;this.days=t.querySelectorAll(".calendar__days>div"),this.days.forEach(t=>{1*t.textContent<(new Date).getDate()+this.minDuration&&this.date.getMonth()==(new Date).getMonth()&&this.date.getFullYear()==(new Date).getFullYear()&&t.classList.add("calendar__prev-date")}),this.days.forEach(e=>{e.addEventListener("click",s=>{e.classList.contains("calendar__prev-date")&&e.classList.contains("calendar__next-date")||(this.days.forEach(t=>{t.classList.remove("active")}),e.classList.add("active"),t.querySelector(".calendar__date>p").innerHTML=e.textContent+" "+this.monthsTitles[this.date.getMonth()]+" "+this.date.getFullYear(),this.activeDate.setDate(e.textContent),this.activeDate.setMonth(this.date.getMonth()),this.activeDate.setFullYear(this.date.getFullYear()),t.querySelector(".calendar__title").innerHTML=this.beautyValue(this.activeDate.getDate())+"."+this.beautyValue(this.activeDate.getMonth()+1)+"."+this.activeDate.getFullYear(),this.correctTime())})})}beautyValue(t){return t.toString().length<2&&(t="0"+t),t}correctTime(){let t=(new Date).getDate()+":"+(new Date).getMonth()+":"+(new Date).getFullYear(),e=this.activeDate.getDate()+":"+this.activeDate.getMonth()+":"+this.activeDate.getFullYear(),s=(new Date).getHours(),i=null,a=(new Date).getMinutes(),n=null;this.element.querySelector(".calendar__timepicker")&&(i=1*this.element.querySelector(".calendar__timepicker").value.split(":")[0],n=1*this.element.querySelector(".calendar__timepicker").value.split(":")[1]),(t==e&&i<=s&&n<a||t==e&&i<s)&&(this.element.querySelector(".calendar__timepicker").value=s+":"+a,this.element.querySelector(".calendar__time").innerHTML=s+":"+a)}}new M(document.querySelector(".options__list.mins"),30,"mins"),new M(document.querySelector(".options__list.hours"),1,"hours");let p=new Date;p.setDate((new Date).getDate()+1),[[l.querySelector(".options__list.mins>.calendar")],[l.querySelector(".options__list.hours>.calendar")],[l.querySelectorAll(".options__list.days>.calendar")[0]],[l.querySelectorAll(".options__list.days>.calendar")[1],p,1]].forEach(t=>{new S(t[0],t[1],t[2]),t[0].querySelector(".calendar__btn").addEventListener("click",()=>{t[0].classList.toggle("active")}),C(t[0])});let q=document.querySelector(".apartments"),w=q.querySelectorAll(".type"),x="list",H=document.querySelector(".search__item.toggle"),L=document.querySelector(".apartments__map"),f=q.offsetTop;H.addEventListener("click",()=>{"list"==x?(x="map",H.textContent="Список",w[0].classList.add("active"),w[1].classList.remove("active"),L.style.marginTop=-f+"px",q.style.padding="0 !important"):(x="list",H.textContent="На карте",w[0].classList.remove("active"),w[1].classList.add("active"),q.style.padding="")}),document.querySelectorAll(".conveniences__item").forEach(t=>{t.addEventListener("click",e=>{t.classList.toggle("active")})});class E{constructor(t,e=0){this.slider=t,this.row=t.querySelector(".slider__row"),this.items=t.querySelectorAll(".slider__item"),this.indents=1*getComputedStyle(this.slider).getPropertyValue("--indents").split("px")[0],this.quantity=1*getComputedStyle(this.slider).getPropertyValue("--quantity"),this.prev=t.querySelector(".slider__toggle.prev"),this.next=t.querySelector(".slider__toggle.next"),this.dots=t.querySelectorAll(".slider__dots-item"),this.index=0,this.interval=e,this.next&&this.next.addEventListener("click",()=>{this.index++,this.toggleSlider()}),this.prev&&this.prev.addEventListener("click",()=>{this.index--,this.toggleSlider()}),this.dots&&this.dots.forEach(t=>{t.addEventListener("click",t=>{for(let e=0;e<this.dots.length;e++)this.dots[e]===t.target?(this.dots[e].classList.add("active"),this.index=e,this.toggleSlider()):this.dots[e].classList.remove("active")})}),this.interval>0&&setInterval(()=>{this.index++,this.toggleSlider()},this.interval)}toggleSlider(){this.index>this.items.length-this.quantity&&(this.index=0),this.index<0&&(this.index=this.items.length-this.quantity),this.dots&&(this.dots.forEach(t=>{t.classList.remove("active")}),this.dots[this.index].classList.add("active")),this.row.style.left=-this.index*(this.items[0].offsetWidth+this.indents)+"px"}}function C(t){$(document).mouseup((function(e){var s=$(t);0===s.has(e.target).length&&s.removeClass("active")}))}function T(t){return t.toString().length<2&&(t="0"+t),t}document.querySelectorAll(".apartments__item__slider").forEach(t=>{new E(t)}),document.querySelectorAll(".apartments__item__favorite").forEach(t=>{t.addEventListener("click",()=>{t.classList.toggle("active")})});let k=document.querySelector(".work__steps");new E(k,5e3);function A(){if(window.matchMedia("(max-width: 1440px)").matches,window.matchMedia("(max-width: 1024px)").matches,window.matchMedia("(max-width: 768px)").matches){let t=document.querySelector(".filter");t.querySelector(".filter__title").addEventListener("click",()=>{t.classList.toggle("active")});let e=document.querySelector(".subway");document.querySelector(".filter__list").insertAdjacentElement("afterbegin",e)}window.matchMedia("(max-width: 576px)").matches,window.matchMedia("(max-width: 360px)").matches}A(),window.addEventListener("resize",A)});